const celularQuestions = [
  {
    question: "Com que frequência você usa o TC no seu dia a dia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você não consegue sair sem levar o TC?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência quando esquece o TC costuma voltar para buscar?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você acessa a internet no TC?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você sente ansiedade quando percebe que está sem o TC?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você se sente triste ou depressivo quando está desconectado da internet ou das redes sociais no seu TC?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você sente nervosismo por não ter o TC por perto para se comunicar?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      'Com que frequência você tem medo de sair sem o TC e, se passar mal na rua, não ter como pedir "socorro" imediato ou fazer contato com alguém de sua confiança?',
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você mantém o TC sempre por perto mesmo em casa?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você mantém o TC ligado 24 horas por dia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você dorme com o TC ligado?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você acessa o TC mais de 30 vezes por dia para ver mensagens, emails, etc.?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você não se desliga do TC quando está com amigos ou família?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você sente solidão, quando não participa de redes sociais ou quando não está inserido em grupos que outros estão?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você insere na agenda do TC o número de um médico, psicólogo ou hospital com medo de passar mal na rua?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você joga no TC?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
];

const tecnologiasQuestions = [
  {
    question:
      "Com que frequência você costuma usar as tecnologias CTCTO por mais de três horas ao longo do seu dia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o CTCTO por mais de quatro horas ao longo do seu dia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência, quando você deixa de usar o CTCTO, você costuma logo em seguida voltar a acessar?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma se sentir mais feliz quando usa o CTCTO no seu dia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma se sentir triste quando não pode acessar o CTCTO no seu dia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma sentir ansiedade quando percebe que está sem acesso às tecnologias CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma sentir algum tipo de desconforto físico, como aperto no peito, bolo na garganta, palpitação, falta de ar ou tontura quando percebe que está sem acesso ao СТСТО?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma sentir medo quando percebe que está sem acesso ao CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma sentir nervosismo quando percebe que está sem acesso ao CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma se sentir rejeitado quando percebe que alguém leu e não respondeu de imediato as suas mensagens ou e-mails no CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o CTCTO para postar algo para ver a reação dos outros e, se for positiva, você se sente mais importante/valorizado?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você se sente desvalorizado/menos importante quando utiliza o CTCTO para postar algo e recebe uma reação negativa dos outros usuários?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o CTCTO para evitar a sensação de estar só?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma consultar ou usar o CTCTO mesmo quando está com amigos ou com o seu par?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma consultar ou usar o CTCTO mesmo quando está no trabalho, em salas de aula ou em outros locais públicos?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma consultar ou usar o CTCTO mesmo quando está com a família?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência durante o seu dia você costuma checar as mensagens no seu CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você deixa de fazer exercícios físicos ou qualquer outra atividade na sua vida real para ficar conectado no mundo virtual do CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma ignorar as pessoas que estão ao seu lado no mundo real para ficar se correspondendo com pessoas no mundo virtual do CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
];

const depressaoQuestions = [
  {
    question:
      "Com que frequência você costuma se sentir muito triste ou deprimido?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você costuma se sentir desanimado?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você costuma sentir nervosismo ou ansiedade?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma se sentir desvalorizado ou não importante?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma sentir perda de interesse nas atividades do cotidiano?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você busca alguma tecnologia CTCTO para não se sentir solitário ou para tentar fazer amigos?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma prejudicar o seu sono para ficar no CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você costuma sentir vontade de morrer?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question: "Com que frequência você costuma pensar em tirar sua vida?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma buscar o CTCTO para descartar a ideia do suicídio ou para pesquisar sobre o tema?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você utiliza o CTCTO para reduzir seus sintomas ou sentimentos pessimistas ou negativos?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma buscar fazer mais amigos no CTCTO do que na vida real?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma buscar o CTCTO para se sentir incluído em algum contexto social?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma buscar o CTCTO para pesquisar sobre curiosidades, novos assuntos, ler jornais ou revistas?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma buscar o CTCTO para mudar o seu estado de humor de negativo para positivo?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma deixar de praticar alguma atividade física ou de fazer programas ao ar livre para ficar no CTCTO?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma buscar o CTCTO para encontrar alguma atividade de lazer ou alguma companhia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
];

const spotifyQuestions = [
  {
    question:
      "Com que frequência você costuma usar o Spotify/Aplicativos de Música Digital (AMD) no seu dia a dia?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma passar mais de 3 horas consecutivas escutando música no Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD durante a prática de exercícios físicos?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD durante reuniões familiares, aulas e/ou trabalho?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD na rua ou em transportes públicos?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD para pegar no sono?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD para não ter a sensação de estar só?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma se distrair de suas atividades, ou do mundo real, ouvindo música no Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD com o som mais alto que o indicado?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD com os fones de ouvido?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      'Com que frequência você costuma escutar "zumbidos" após o uso do Spotify/AMD com os fones de ouvido?',
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma criar listas de músicas no Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma compartilhar listas de músicas criadas no Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma se sentir valorizado quando alguém curte suas listas de músicas do Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma acompanhar as listas de músicas que seus colegas estão ouvindo no Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma conversar com colegas sobre Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma pesquisar novas bandas, artistas e tendências musicais no Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma buscar outras funções do aplicativo Spotify/AMD que não seja somente ouvir música?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma usar o Spotify/AMD conectado à internet?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
  {
    question:
      "Com que frequência você costuma procurar por listas de músicas patrocinadas no Spotify/AMD?",
    options: ["Nunca / Raramente", "Frequentemente", "Sempre"],
    values: [0, 1, 2],
  },
];

const quizTitles = {
  celular: "Dependência do Telefone Celular",
  tecnologias: "Uso Abusivo das Tecnologias",
  depressao: "Depressão e sua Relação com a Dependência de Tecnologias",
  spotify: "Dependência de Spotify e Aplicativos de Música Digital",
};

const quizzes = {
  celular: celularQuestions,
  tecnologias: tecnologiasQuestions,
  depressao: depressaoQuestions,
  spotify: spotifyQuestions,
};

let quizQuestions = [];

let currentQuestionIndex = 0;

let userAnswers = [];

let totalScore = 0;

const questionContainer = document.getElementById("question-container");
const questionText = document.getElementById("question-text");
const optionsContainer = document.querySelector(".options");
const prevBtn = document.getElementById("prev-btn");
const nextBtn = document.getElementById("next-btn");
const progressFill = document.getElementById("progress-fill");
const scoreElement = document.getElementById("score");
const scoreFill = document.getElementById("score-fill");
const recommendationsElement = document.getElementById("recommendations");
const reflectionText = document.getElementById("reflection-text");
const saveReflectionBtn = document.getElementById("save-reflection");
const contactForm = document.getElementById("contact-form");
const darkModeToggle = document.getElementById("dark-mode-toggle");
const popup = document.getElementById("popup");
const popupMessage = document.getElementById("popup-message");
const closeBtn = document.querySelector(".close-btn");

function initQuiz() {
  if (questionContainer && questionText && optionsContainer) {
    showQuestion(currentQuestionIndex);
    updateProgressBar();
  }
}

function showQuestion(index) {
  const question = quizQuestions[index];
  questionText.textContent = question.question;

  optionsContainer.innerHTML = "";
  question.options.forEach((option, optionIndex) => {
    const button = document.createElement("button");
    button.className = "option-btn";
    button.textContent = option;
    button.dataset.value = question.values[optionIndex];
    if (userAnswers[index] === question.values[optionIndex]) {
      button.classList.add("selected");
    }
    button.addEventListener("click", () =>
      selectOption(optionIndex, question.values[optionIndex])
    );
    optionsContainer.appendChild(button);
  });

  prevBtn.disabled = index === 0;
  nextBtn.textContent =
    index === quizQuestions.length - 1 ? "Finalizar" : "Próxima";
}

function selectOption(optionIndex, value) {
  userAnswers[currentQuestionIndex] = value;
  const buttons = optionsContainer.querySelectorAll(".option-btn");
  buttons.forEach((btn, idx) => {
    btn.classList.toggle("selected", idx === optionIndex);
  });
}

function nextQuestion() {
  if (currentQuestionIndex < quizQuestions.length - 1) {
    currentQuestionIndex++;
    showQuestion(currentQuestionIndex);
    updateProgressBar();
  } else {
    calculateScore();
    window.location.href = "resultados.html";
  }
}

function prevQuestion() {
  if (currentQuestionIndex > 0) {
    currentQuestionIndex--;
    showQuestion(currentQuestionIndex);
    updateProgressBar();
  }
}

function updateProgressBar() {
  const progress = ((currentQuestionIndex + 1) / quizQuestions.length) * 100;
  progressFill.style.width = `${progress}%`;
}

function calculateScore() {
  totalScore = userAnswers.reduce((sum, answer) => sum + answer, 0);
  localStorage.setItem("quizScore", totalScore);
  localStorage.setItem("userAnswers", JSON.stringify(userAnswers));
}

function displayResults() {
  if (scoreElement && scoreFill && recommendationsElement) {
    const score = localStorage.getItem("quizScore");
    const selectedQuiz = localStorage.getItem("selectedQuiz");
    if (score && selectedQuiz) {
      const maxScore = quizzes[selectedQuiz].length * 2;
      scoreElement.textContent = `${score}/${maxScore}`;
      const scorePercentage = (score / maxScore) * 100;
      scoreFill.style.width = `${scorePercentage}%`;

      let recommendations = "";
      if (score <= maxScore * 0.3) {
        recommendations = `
                    <h4>Excelente! Você tem hábitos muito saudáveis nesta área.</h4>
                    <ul>
                        <li>Continue mantendo o equilíbrio.</li>
                        <li>Compartilhe suas práticas com outros.</li>
                        <li>Considere ajudar outros a adotarem hábitos similares.</li>
                    </ul>
                `;
      } else if (score <= maxScore * 0.5) {
        recommendations = `
                    <h4>Boa! Seus hábitos são relativamente saudáveis.</h4>
                    <ul>
                        <li>Reduza ligeiramente o uso antes de dormir.</li>
                        <li>Estabeleça limites mais claros.</li>
                        <li>Incorpore mais atividades offline.</li>
                    </ul>
                `;
      } else if (score <= maxScore * 0.7) {
        recommendations = `
                    <h4>Atenção! Há espaço para melhorias.</h4>
                    <ul>
                        <li>Implemente períodos de "desconexão".</li>
                        <li>Desative notificações não essenciais.</li>
                        <li>Pratique mindfulness.</li>
                    </ul>
                `;
      } else {
        recommendations = `
                    <h4>Cuidado! Pode estar afetando sua saúde.</h4>
                    <ul>
                        <li>Considere um detox completo.</li>
                        <li>Busque ajuda profissional se sentir dependente.</li>
                        <li>Reduza drasticamente e aumente atividades offline.</li>
                    </ul>
                `;
      }
      recommendationsElement.innerHTML = recommendations;
    }
  }
}

function saveReflection() {
  const reflection = reflectionText.value;
  if (reflection.trim()) {
    localStorage.setItem("dailyReflection", reflection);
    showPopup("Reflexão salva com sucesso!");
    reflectionText.value = "";
  } else {
    showPopup("Por favor, escreva algo antes de salvar.");
  }
}

function showPopup(message) {
  popupMessage.textContent = message;
  popup.style.display = "block";
}

function closePopup() {
  popup.style.display = "none";
}

function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
  const isDarkMode = document.body.classList.contains("dark-mode");
  localStorage.setItem("darkMode", isDarkMode);
  darkModeToggle.innerHTML = isDarkMode
    ? '<i class="fas fa-sun"></i>'
    : '<i class="fas fa-moon"></i>';
}

function loadDarkModePreference() {
  const darkMode = localStorage.getItem("darkMode") === "true";
  if (darkMode) {
    document.body.classList.add("dark-mode");
    darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
  }
}

function smoothScroll(target) {
  const element = document.querySelector(target);
  if (element) {
    element.scrollIntoView({ behavior: "smooth" });
  }
}

function handleFormSubmission(e) {
  e.preventDefault();
  const formData = new FormData(contactForm);
  const name = formData.get("name");
  const email = formData.get("email");
  const message = formData.get("message");

  if (name && email && message) {
    showPopup("Mensagem enviada com sucesso! Entraremos em contato em breve.");
    contactForm.reset();
  } else {
    showPopup("Por favor, preencha todos os campos.");
  }
}

let currentSlide = 0;
const slides = document.querySelectorAll(".media-item");

function showSlide(index) {
  slides.forEach((slide, i) => {
    slide.style.display = i === index ? "block" : "none";
  });
}

function nextSlide() {
  currentSlide = (currentSlide + 1) % slides.length;
  showSlide(currentSlide);
}

function prevSlide() {
  currentSlide = (currentSlide - 1 + slides.length) % slides.length;
  showSlide(currentSlide);
}

function changeMenuOnScroll() {
  const header = document.querySelector("header");
  if (window.scrollY > 100) {
    header.style.backgroundColor = "rgba(44, 62, 80, 0.9)";
  } else {
    header.style.backgroundColor = "#2c3e50";
  }
}

function animateOnScroll() {
  const elements = document.querySelectorAll(
    ".feature-item, .practice-item, .team-member, .quiz-card, .media-item"
  );
  elements.forEach((element) => {
    const elementTop = element.getBoundingClientRect().top;
    const elementBottom = element.getBoundingClientRect().bottom;
    if (elementTop < window.innerHeight && elementBottom > 0) {
      element.classList.add("fade-in");
    }
  });
}

function selectQuiz(quizType) {
  quizQuestions = quizzes[quizType];
  localStorage.setItem("selectedQuiz", quizType);
  document.getElementById("quiz-selection").style.display = "none";
  const quizTitleElement = document.getElementById("quiz-title");
  if (quizTitleElement) {
    quizTitleElement.textContent = quizTitles[quizType];
    quizTitleElement.style.display = "block";
  }
  showAllQuestions(quizQuestions);
  document.getElementById("quiz-form").style.display = "block";
}

function showAllQuestions(questions) {
  const form = document.getElementById("quiz-form");
  form.innerHTML = "";
  questions.forEach((question, index) => {
    const questionDiv = document.createElement("div");
    questionDiv.className = "question";
    questionDiv.innerHTML = `
      <h3>${index + 1}. ${question.question}</h3>
      <div class="options">
        ${question.options
          .map(
            (option, optIndex) => `
          <label>
            <input type="radio" name="question-${index}" value="${question.values[optIndex]}" required>
            ${option}
          </label>
        `
          )
          .join("")}
      </div>
    `;
    form.appendChild(questionDiv);
  });
  const submitBtn = document.createElement("button");
  submitBtn.type = "submit";
  submitBtn.className = "btn-nav";
  submitBtn.textContent = "Finalizar";
  form.appendChild(submitBtn);
}

document.addEventListener("DOMContentLoaded", function () {
  const quizButtons = document.querySelectorAll(".quiz-btn");
  quizButtons.forEach((button) => {
    button.addEventListener("click", function () {
      const quizType = this.dataset.quiz;
      selectQuiz(quizType);
    });
  });
  const quizCards = document.querySelectorAll(".quiz-card");
  quizCards.forEach((card) => {
    card.addEventListener("click", function () {
      const quizType = this.dataset.quiz;
      selectQuiz(quizType);
    });
  });
  if (nextBtn && prevBtn) {
    nextBtn.addEventListener("click", nextQuestion);
    prevBtn.addEventListener("click", prevQuestion);
  }
  if (window.location.pathname.includes("resultados.html")) {
    displayResults();
  }
  if (saveReflectionBtn) {
    saveReflectionBtn.addEventListener("click", saveReflection);
  }
  if (contactForm) {
    contactForm.addEventListener("submit", handleFormSubmission);
  }
  const quizForm = document.getElementById("quiz-form");
  if (quizForm) {
    quizForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const formData = new FormData(quizForm);
      const answers = [];
      for (let i = 0; i < quizQuestions.length; i++) {
        const value = formData.get(`question-${i}`);
        answers.push(parseInt(value));
      }
      totalScore = answers.reduce((sum, answer) => sum + answer, 0);
      localStorage.setItem("quizScore", totalScore);
      localStorage.setItem("userAnswers", JSON.stringify(answers));
      window.location.href = "resultados.html";
    });
  }
  if (darkModeToggle) {
    darkModeToggle.addEventListener("click", toggleDarkMode);
  }
  loadDarkModePreference();
  const navLinks = document.querySelectorAll('nav a[href^="#"]');
  navLinks.forEach((link) => {
    link.addEventListener("click", function (e) {
      e.preventDefault();
      const target = this.getAttribute("href");
      smoothScroll(target);
    });
  });
  if (closeBtn) {
    closeBtn.addEventListener("click", closePopup);
  }
  window.addEventListener("click", function (e) {
    if (e.target === popup) {
      closePopup();
    }
  });

  if (document.querySelector(".quiz-section")) {
    initQuiz();
  }
  if (slides.length > 0) {
    showSlide(currentSlide);
    setInterval(nextSlide, 5000);
  }
  window.addEventListener("scroll", function () {
    changeMenuOnScroll();
    animateOnScroll();
  });
  const buttons = document.querySelectorAll(
    "button, .btn-primary, .btn-secondary"
  );
  buttons.forEach((button) => {
    button.addEventListener("mouseenter", function () {
      this.style.transform = "scale(1.05)";
    });
    button.addEventListener("mouseleave", function () {
      this.style.transform = "scale(1)";
    });
  });
});
